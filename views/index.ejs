<!doctype html>
<%- include("head"); %>
<body id="page">
  <nav>
    <h1 id="name"><%=NAME%></h1>
  </nav>
  <% if (locals.publicRooms && locals.rooms && rooms.length > 0) { %>
  <article id="room-directory">
    <h2 class="rd-title">Rooms</h2>
    <div class="room-cards">
      <% for (const room of rooms) { %>
      <a href="/r/<%= room.roomid %>" class="room-card">
        <div class="room-card-name"><%= room.name || room.roomid %></div>
        <% if (room.motd) { %>
        <div class="room-card-motd"><%= room.motd %></div>
        <% } %>
        <div class="room-card-stats">
          <span class="rc-stat"><%= room.files %> files</span>
          <% if (room.users > 0) { %>
          <span class="rc-stat rc-stat-live"><%= room.users %> online</span>
          <% } %>
        </div>
      </a>
      <% } %>
    </div>
  </article>
  <% } else if (locals.publicRooms && locals.rooms && rooms.length === 0) { %>
  <article id="room-directory-empty">
    <h2>No rooms yet</h2>
    <p>Be the first — <a href="/new">create a room</a> to start sharing.</p>
  </article>
  <% } else { %>
  <article>
    <h2>Welcome to Dicefiles</h2>
    <p>A self-hosted file sharing platform designed for hobby communities.</p>

    <p>Share your roleplaying books, digital maps, board games, STL models, fiction, and more with like-minded hobbyists in real-time chat rooms.</p>

    <h3>Quick Start</h3>
    <ul>
      <li><a href="/new">Create a new room</a> to start sharing with your community</li>
      <li>Visit an existing room URL to join (e.g., <code>/r/your-room-name</code>)</li>
    </ul>

    <h3>Managing Your Room</h3>
    <ul>
      <li><strong>Create rooms:</strong> Navigate to <a href="/new">Create Room</a> or go directly to a URL like <code>/r/my-room</code></li>
      <li><strong>Upload files:</strong> Drag and drop or use the upload button in your room</li>
      <li><strong>Chat:</strong> Real-time messaging with all room participants</li>
      <li><strong>Register:</strong> Create an account to keep your nickname and access moderation tools</li>
      <li><strong>Moderation:</strong> Room owners can moderate their own space</li>
    </ul>

    <h3>Key Features</h3>
    <ul>
      <li>✓ Real-time chat and file sharing</li>
      <li>✓ File previews (images, videos, audio, PDFs)</li>
      <li>✓ User accounts and persistent nicknames</li>
      <li>✓ Room ownership and moderation</li>
      <li>✓ Self-hosted - you control your data</li>
      <li>✓ Ephemeral files - expired uploads are automatically deleted</li>
    </ul>

    <h3>Getting Help</h3>
    <ul>
      <li>Read our <a href="/terms">Terms of Service</a></li>
      <li>Review our <a href="/rules">Rules</a></li>
      <li>Check out our <a href="https://github.com/apoapostolov/dicefiles" target="_blank">GitHub repository</a></li>
    </ul>
  </article>
  <% } %>
  <%- include("footer"); %>
</body>
