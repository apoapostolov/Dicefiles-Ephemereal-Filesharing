#filelist {
  font-size: var(--files-size);
  grid-area: files;
  background: var(--dark-bg);
  overflow: hidden;
  user-select: none;
  position: relative;
}

#filelist-scroller {
  grid-area: files;
}

#files {
  height: 100%;
  overflow-x: hidden;
  overflow-y: scroll;
  box-sizing: border-box;
}

#files.listmode:not(.hidden) {
  display: block !important;
  gap: 0 !important;
}

#files.listmode > .file:not(.upload) {
  width: 100% !important;
  max-width: 100% !important;
  flex: 0 0 auto !important;
}

.empty #filelist,
.empty #filelist-scroller {
  opacity: 0.3;
}

/* links panel is inside #filelist — override the empty dimming */
body.links-mode #filelist,
body.links-mode #filelist-scroller {
  opacity: 1 !important;
}

#dropminder {
  grid-area: files;
  background: linear-gradient(
    180deg,
    rgba(16, 16, 16, 0.95),
    rgba(20, 20, 20, 0.9)
  );
  padding: 9vh 12%;
  display: none;
}

.empty #dropminder {
  display: block;
}

#dropminder svg {
  display: inline-block;
  width: 100%;
  height: 100%;
  margin-left: auto;
  opacity: 0.78;
}

/* because firefox
.empty rect {
  animation: 5s linear infinite spin, 10s ease-in infinite opulse;
  transform-origin: 50% 50% 0px;
}
*/

#files > .file {
  display: flex;
  align-items: center;
  justify-content: center;
  align-content: center;
  width: 100%;
  padding: 0.42rem 0.9rem;
  border: 1px solid rgba(255, 255, 255, 0.03);
  border-left: 2px solid transparent;
  transition:
    background 0.2s ease,
    border-color 0.2s ease;
}

#files > .file:nth-child(even) {
  background: var(--odd-bg);
}

#files > .file.selected {
  background: var(--sel-bg) !important;
}

#files > .file.selected:nth-child(even) {
  background: var(--odd-sel-bg) !important;
}

#files > .file:hover {
  background: rgba(255, 255, 255, 0.06);
  border-left-color: rgba(255, 255, 255, 0.22);
}

#files > .file.notification-focus {
  background: rgba(176, 219, 255, 0.14) !important;
  border-left-color: rgba(176, 219, 255, 0.86) !important;
}

#files > .file.hidden-file .name {
  text-decoration: line-through !important;
}

#files > .file.upload {
  background: var(--upload-bg);
  background-image: repeating-linear-gradient(
    60deg,
    rgba(0, 0, 0, 0.5),
    rgba(0, 0, 0, 0.5) 20px,
    rgba(0, 0, 0, 0.3) 20px,
    rgba(0, 0, 0, 0.3) 40px
  );
  background-size: 0% 100%;
  background-repeat: no-repeat;
}

#files > .file.upload > .icon.abort {
  cursor: pointer;
}

#files > .file.error {
  background: var(--err-bg);
}

#files > .file a,
#files > .file span {
  display: inline-block;
  padding-right: 1ex;
  color: var(--text-fg);
  text-decoration: none;
  white-space: nowrap;
}

#files > .file a:hover {
  color: var(--dark-fg);
}

#files > .file > .name {
  flex: 1;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 0.35rem;
  font-weight: 500;
  color: #efefef;
}

#files > .file.is-new > .name {
  color: #ddf2e3;
}

#files > .file.request-file > .name,
#files > .file.request-file.is-new > .name {
  color: #f5eaa4;
}

#files > .file > .name > .name-text {
  flex: 0 1 auto;
  min-width: 0;
  max-width: calc(100% - 3.8em);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

#files > .file > .name > .file-new-pill {
  display: none;
  flex: 0 0 auto;
  font-size: 9px;
  background: rgba(214, 247, 222, 0.22);
  border: 1px solid rgba(214, 247, 222, 0.52);
  color: #e9fceb;
  border-radius: 999px;
  padding: 2px 0.62ex;
  font-weight: 700;
  letter-spacing: 0.02em;
}

#files > .file.request-file > .name > .request-url {
  flex: 0 0 auto;
  font-size: 12px;
  opacity: 0.82;
  padding-right: 0;
  margin-left: 0.1rem;
  color: #f6eec2;
}

#files > .file.request-file > .name > .request-url:hover {
  opacity: 1;
  color: #fff4b9;
}

#files > .file > .detail > .file-copy-meta-detail {
  flex: 0 0 auto;
  border-left: 0;
  padding-left: 0;
  margin-left: auto;
  font-size: 12px;
  opacity: 0.74;
  color: rgba(226, 226, 226, 0.92);
}

#files > .file > .detail > .file-copy-meta-detail:hover {
  opacity: 1;
  color: #ffffff;
}

#files > .file.is-new > .name > .file-new-pill {
  display: inline-block;
}

#files > .file.request-file > .name > .file-new-pill {
  background: rgba(245, 234, 164, 0.22);
  border-color: rgba(245, 234, 164, 0.56);
  color: #fff8d5;
}

/* Fulfilled request: dimmed text + Fulfilled pill */
#files > .file.request-file.request-fulfilled > .name {
  color: #888;
}

#files > .file.request-file.request-fulfilled > .name > .name-text {
  color: #888;
}

#files > .file.request-file.request-fulfilled > .icon {
  opacity: 0.45;
}

/* Grey "Fulfilled" pill that appears after the request text */
#files > .file.request-file > .name > .request-fulfilled-pill {
  display: none;
  flex: 0 0 auto;
  font-size: 9px;
  background: rgba(160, 160, 160, 0.16);
  border: 1px solid rgba(160, 160, 160, 0.38);
  color: #999;
  border-radius: 999px;
  padding: 2px 0.62ex;
  font-weight: 600;
  letter-spacing: 0.03em;
  margin-left: 0.3em;
}
#files > .file.request-file.request-fulfilled > .name > .request-fulfilled-pill {
  display: inline-flex;
  align-items: center;
}

/* Make request files show a pointer cursor to hint they're clickable */
#files > .file.request-file > .name {
  cursor: pointer;
}

#files:not(.gallerymode) > .file .galleryonly {
  display: none;
}

#files > .file > .tags {
  display: flex;
  align-items: center;
  align-content: center;
  justify-content: flex-end;
  padding: 0 1em;
  max-width: 66%;
  overflow-x: hidden;
}

#files > .file > .tags > .tag {
  font-size: 10px;
  background: var(--surface-2);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 999px;
  padding: 2px 0.7ex;
  margin-left: 0.7ex;
  cursor: pointer;
  max-width: 25ex;
  overflow-x: hidden;
  text-overflow: ellipsis;
  transition:
    background 0.2s ease,
    border-color 0.2s ease;
}

#files > .file > .tags > .tag:hover {
  background: var(--surface-3);
  border-color: rgba(255, 255, 255, 0.24);
}

.tags > .tag-user {
  background: rgba(90, 160, 90, 0.4) !important;
}

#files > .file > .i-upload {
  animation: opulse 2s infinite ease-in;
}

#files > .file > .i-wait {
  opacity: 0.5;
}

#files > .file > .detail {
  display: flex;
  width: 212px;
  white-space: nowrap;
  justify-content: flex-end;
  gap: 0.15rem;
}

#files > .file > .detail,
#files > .file > .detail-progress {
  font-size: var(--detail-size);
}

#files > .file > .detail > span {
  display: inline-block;
  border-left: 1px solid rgba(255, 255, 255, 0.24);
  padding-left: 0.65ex;
  flex: 2;
  overflow: hidden;
  text-overflow: ellipsis;
  letter-spacing: 0.01em;
}

#files > .file > .detail > .ttl {
  flex: 3;
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  color: #dbdbdb;
  font-weight: 600;
}

#files > .file > .detail > .ttl > .ttl-value {
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
}

#files > .file > .detail > .size {
  color: #f1f1f1;
}

#files > .file > .detail > .size.size-placeholder {
  visibility: hidden;
}

#files.gallerymode {
  display: flex;
  flex-wrap: wrap;
  font-size: small;
  justify-content: flex-start;
  align-content: flex-start;
  align-items: flex-start;
  gap: 0.85rem;
}

/* Hide request-file tiles in gallery mode — they have no cover to show */
#files.gallerymode > .file.request-file {
  display: none !important;
}

#files.gallerymode > .file:not(.upload):not(.request-file) {
  position: relative;
  display: block !important;
  width: 250px !important;
  height: 340px !important;
  margin: 0;
  padding: 0;
  border: 1px solid rgba(255, 255, 255, 0.22) !important;
  border-radius: 10px;
  overflow: hidden;
  background: rgba(18, 18, 18, 0.9) !important;
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.35);
}

#files.gallerymode > .file.selected:not(.upload) {
  border: 1px solid rgba(231, 239, 231, 0.9) !important;
  box-shadow:
    0 0 0 1px rgba(203, 232, 205, 0.55),
    0 8px 20px rgba(0, 0, 0, 0.45);
}

#files.gallerymode > .file:not(.upload) > * {
  margin: 0 !important;
  padding: 0 !important;
}

#files.gallerymode > .file:not(.upload) .icon {
  display: none;
}

#files.gallerymode > .file:not(.upload) .name {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 2.1rem;
  z-index: 6;
  display: flex;
  align-items: flex-end;
  justify-content: flex-start;
  gap: 0.38rem;
  width: auto;
  max-width: 100%;
  height: 2.1rem;
  padding: 0.2rem 0.65rem !important;
  box-sizing: border-box;
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0) 0%,
    rgba(255, 255, 255, 0.78) 20%,
    rgba(255, 255, 255, 0.78) 100%
  );
  color: rgba(52, 52, 52, 0.98);
  font-weight: 700;
  text-overflow: ellipsis;
  overflow: hidden;
  white-space: nowrap;
}

#files.gallerymode > .file:not(.upload) > .name > .name-text {
  flex: 0 1 auto;
  min-width: 0;
  max-width: calc(100% - 4.15em);
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  color: rgba(52, 52, 52, 0.98);
}

#files.gallerymode .preview {
  position: absolute;
  inset: 0;
  z-index: 1;
  display: flex;
  align-content: flex-start;
  justify-content: center;
  align-items: flex-start;
  overflow: hidden;
}

#files.gallerymode .preview video,
#files.gallerymode .preview img {
  width: 100%;
  height: 100%;
  max-width: none;
  max-height: none;
  object-fit: cover;
  object-position: top center;
}

#files.gallerymode .preview .faticon {
  font-size: 140px;
  padding: 0;
  margin: 0;
  color: rgba(255, 255, 255, 0.65);
  align-self: center;
}

#files.gallerymode > .file:not(.upload) .detail {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  z-index: 7;
  display: flex;
  align-items: center;
  justify-content: flex-start;
  gap: 0.4rem;
  width: auto;
  max-width: 100%;
  height: 2.1rem;
  white-space: nowrap;
  padding: 0.2rem 0.55rem !important;
  box-sizing: border-box;
  background: rgba(255, 255, 255, 0.78);
  color: rgba(20, 20, 20, 0.96);
  font-size: 11px;
  font-weight: 600;
}

#files.gallerymode > .file:not(.upload) > .detail > span {
  border: 0;
  padding: 0;
  margin: 0;
  min-width: 0;
  flex: 0 0 auto;
}

#files.gallerymode
  > .file:not(.upload)
  > .detail
  > .galleryonly:not(.type-pill) {
  display: none;
}

#files.gallerymode > .file:not(.upload) > .detail > .type-pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  line-height: 1;
  border-radius: 999px;
  padding: 0.12rem 0.5rem;
  min-width: calc(3ch + 4px);
  background: rgba(116, 116, 116, 0.88);
  border: 1px solid rgba(86, 86, 86, 0.92);
  color: rgba(250, 250, 250, 0.98);
  font-weight: 700;
  letter-spacing: 0.01em;
  white-space: nowrap;
  text-indent: 0;
}

#files.gallerymode > .file:not(.upload) > .detail > .size {
  order: 3;
  margin-left: auto;
  text-align: right;
  color: rgba(24, 24, 24, 0.95);
  font-weight: 700;
  font-size: 13px;
}

#files.gallerymode > .file:not(.upload) > .detail > .ttl {
  order: 2;
  margin: 0;
  padding-right: 0;
  flex: 1 1 auto;
  justify-content: center;
  text-align: center;
  color: rgba(62, 62, 62, 0.96);
  gap: 0.2rem;
}

#files.gallerymode > .file:not(.upload) > .detail > .ttl > .i-clock,
#files.gallerymode > .file:not(.upload) > .detail > .ttl > .ttl-value {
  color: rgba(62, 62, 62, 0.96);
}

#files.gallerymode
  > .file:not(.upload)
  > .detail
  > .ttl
  > .file-copy-meta-detail {
  color: rgba(18, 18, 18, 0.9);
  opacity: 0.88;
}

#files.gallerymode
  > .file:not(.upload)
  > .detail
  > .ttl
  > .file-copy-meta-detail:hover {
  opacity: 1;
  color: rgba(0, 0, 0, 1);
}

#files.gallerymode > .file:not(.upload) .tags {
  display: none;
}

#files.gallerymode > .file:not(.upload) .tags > .tag {
  margin: 0;
  max-width: 100%;
  background: rgba(13, 13, 13, 0.18);
  border-color: rgba(20, 20, 20, 0.2);
  color: rgba(18, 18, 18, 0.94);
}

#files.gallerymode
  > .file:not(.upload)
  .tags
  > .tag:not(.tag-user):not(.tag-usernick) {
  display: none;
}

#files.gallerymode > .file:not(.upload) .tags > .tag-user,
#files.gallerymode > .file:not(.upload) .tags > .tag-usernick {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  background: rgba(46, 111, 60, 0.96) !important;
  border-color: rgba(26, 75, 40, 0.92);
  color: rgba(255, 255, 255, 0.98);
  font-weight: 700;
}

#files.gallerymode > .file.request-file .name {
  color: rgba(64, 48, 8, 0.95);
}

#files.gallerymode > .file.request-file > .detail {
  color: rgba(60, 47, 10, 0.95);
}

#files.gallerymode > .file.request-file > .detail > .type-pill {
  background: rgba(255, 239, 176, 0.38);
  border-color: rgba(140, 114, 42, 0.3);
}

#files.gallerymode > .file:not(.upload).is-new > .name {
  color: rgba(52, 52, 52, 0.98);
}

#files.gallerymode > .file:not(.upload).is-new > .name > .name-text {
  color: inherit;
}

#files.gallerymode > .file:not(.upload).is-new > .name > .file-new-pill {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: 0.45rem;
  background: rgba(24, 96, 41, 0.98);
  border-color: rgba(15, 64, 28, 0.98);
  color: rgba(255, 255, 255, 0.99);
}

#files.gallerymode > .file:not(.upload) .tags > .tag {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
}

#files.gallerymode > .file:not(.upload) > .name > .request-url {
  margin-left: 0.35rem;
  color: inherit;
}

#files.gallerymode > .file:not(.upload) > .detail > span:not(.type-pill) {
  border-left: 0 !important;
  padding-left: 0 !important;
  margin: 0;
}

@keyframes spin {
  50% {
    transform: scale(0.9);
  }
}

/* ─── Links Archive ─────────────────────────────────────────────────────── */

#links {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow-x: hidden;
  overflow-y: scroll;
  box-sizing: border-box;
  background: var(--dark-bg);
  color: var(--text-fg);
  /* hide native scrollbar — custom scroller track is used instead */
  scrollbar-width: none;
  -ms-overflow-style: none;
}

/* ─── Links Archive header row ─────────────────────────────────────────── */
#links::before {
  content: "";
  display: block;
  height: 28px;
}

#links-header {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 28px;
  display: flex;
  align-items: center;
  padding: 0 0.9rem;
  background: var(--hi-bg);
  border-bottom: 1px solid var(--hairline);
  font-size: 8.5pt;
  font-weight: 600;
  color: var(--dark-fg);
  letter-spacing: 0.04em;
  text-transform: uppercase;
  z-index: 2;
  pointer-events: none;
  box-sizing: border-box;
}

#links-header .lh-name {
  flex: 1;
  min-width: 0;
}

#links-header .lh-tags {
  display: flex;
  flex: 0 0 auto;
  padding: 0 0.5em;
  width: 90px;
  justify-content: flex-end;
}

#links-header .lh-detail {
  width: 72px;
  flex: 0 0 auto;
  text-align: right;
}

#links::-webkit-scrollbar {
  display: none;
}

#links.listmode:not(.hidden) {
  display: block !important;
}

/* hide the drop-zone overlay when in links-mode */
body.links-mode #dropminder {
  display: none !important;
}

#links > .file {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  align-content: center;
  width: 100%;
  padding: 0.42rem 0.9rem;
  border: 1px solid rgba(255, 255, 255, 0.03);
  border-left: 2px solid transparent;
  text-decoration: none;
  box-sizing: border-box;
  transition:
    background 0.2s ease,
    border-color 0.2s ease;
}

#links > .file:nth-child(even) {
  background: var(--odd-bg);
}

#links > .file:hover {
  background: rgba(255, 255, 255, 0.06);
  border-left-color: rgba(255, 255, 255, 0.22);
}

#links > .file > .name {
  flex: 1;
  min-width: 0;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: center;
  gap: 0.1rem;
}

#links > .file > .name > .name-primary {
  display: flex;
  align-items: center;
  gap: 0.35rem;
  max-width: 100%;
  overflow: hidden;
}

#links > .file > .name > .name-primary > .name-text {
  flex: 0 1 auto;
  min-width: 0;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-weight: 500;
  color: #efefef;
}

#links > .file.is-new > .name > .name-primary > .name-text {
  color: #ddf2e3;
}

#links > .file > .name > .name-primary > .file-new-pill {
  display: none;
  flex: 0 0 auto;
  font-size: 9px;
  background: rgba(214, 247, 222, 0.22);
  border: 1px solid rgba(214, 247, 222, 0.52);
  color: #e9fceb;
  border-radius: 999px;
  padding: 2px 0.62ex;
  font-weight: 700;
  letter-spacing: 0.02em;
}

#links > .file.is-new > .name > .name-primary > .file-new-pill {
  display: inline-block;
}

#links > .file > .name > .url-sub {
  max-width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  font-size: var(--detail-size);
  color: var(--dark-fg);
  opacity: 0.75;
}

#links > .file > .tags {
  display: flex;
  align-items: center;
  align-content: center;
  justify-content: flex-end;
  padding: 0 0.5em;
  flex: 0 0 auto;
  overflow-x: hidden;
}

#links > .file > .tags > .tag {
  font-size: 10px;
  background: var(--surface-2);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 999px;
  padding: 2px 0.7ex;
  margin-left: 0.7ex;
  max-width: 20ex;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  transition:
    background 0.2s ease,
    border-color 0.2s ease;
}

#links > .file > .tags > .tag-user {
  background: rgba(90, 160, 90, 0.4) !important;
}

#links > .file > .detail {
  display: flex;
  width: 72px;
  flex: 0 0 auto;
  white-space: nowrap;
  justify-content: flex-end;
  font-size: var(--detail-size);
}

#links > .file > .detail > .ttl {
  border-left: 1px solid rgba(255, 255, 255, 0.24);
  padding-left: 0.65ex;
  color: #dbdbdb;
  font-weight: 600;
  letter-spacing: 0.01em;
}
